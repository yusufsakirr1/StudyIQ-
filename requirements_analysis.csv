ID,Type,Title,Description,Priority,Acceptance Criteria,Notes
FR1,Functional,User Registration and Authentication,"Users can register with email/password, login, logout, and the app retains auth state.",High,"1) User can sign up with name, email, password. 2) User can login. 3) Auth state persists between launches.","Uses AuthService (src/services/firebaseAuthService). Verify firebase project and google-services.json"
FR2,Functional,Onboarding,"Show onboarding on first launch and store seen flag.",Medium,"1) First launch shows onboarding pages. 2) After completing onboarding, it doesn't show again.","AsyncStorage key 'hasSeenOnboarding' used in App.tsx"
FR3,Functional,Notes CRUD,"Create, Read, Update, Delete notes with Firestore persistence and offline support.",High,"1) Create note stored in Firestore. 2) Edit updates Firestore. 3) Delete removes note. 4) Offline edits sync when online.","NotesService handles operations; Firestore persistence enabled in src/firebase/config.ts"
FR4,Functional,AI Note Processing,"Process user notes using OpenAI to produce summary/detailed notes via cloud function proxy.",High,"1) User submits note for processing. 2) App shows processing state. 3) Processed result saved/displayed. 4) Errors handled gracefully.","openaiService and Firebase Cloud Function openaiProxy used; timeout handling required"
FR5,Functional,AI Teacher Chat,"Bidirectional chat with AI Teacher using conversation context, language detection, per-day limits.",High,"1) Send user message and receive AI response. 2) Context includes last 5 messages. 3) Language detection (tr/en). 4) Daily usage limits enforced.","aiTeacherService handles prompts, buildContextMessages and error mapping; SubscriptionContext enforces limits"
FR6,Functional,Subscription Management & IAP,"Display plans, purchase via react-native-iap, and apply plan limits to usage.",High,"1) Plans listed. 2) Purchase flows open store. 3) After purchase, plan status updates. 4) Limits change according to plan.","iapService and SubscriptionContext manage flows. Add server-side receipt validation for security"
FR7,Functional,Usage Tracking & Limits,"Track daily usage counters (aiMessages, notesCreated, notesShared, pdfExports, studySessions) and prevent actions when exceeded.",High,"1) Usage increments on actions. 2) canPerformAction returns true/false. 3) UI shows remaining usage.","SubscriptionContext stores usage and limits. PlanTestScreen for testing increments"
FR8,Functional,PDF Export,"Allow exporting notes as PDF (feature flag / limit obeyed).",Medium,"1) User can request PDF export. 2) Export counts against pdfExports limit. 3) Export file available to user.","Implementation placeholder in app; integrate pdf generation library (react-native-pdf or rn-pdf-generator)"
FR9,Functional,Camera Integration,"Add photos to notes through camera UI.",Low,"1) CameraScreen able to capture placeholder image. 2) Captured image attached to note. 3) Permissions requested.","CameraScreen currently placeholder; implement react-native-camera or expo-camera"
FR10,Functional,Legal Screens,"Show Privacy Policy, Terms of Service, Terms of Use, AI Disclaimer.",Low,"1) Legal screen has tabs. 2) Individual legal document screens render text.","Files under src/legal exist already"
FR11,Functional,Error Handling & Localized Messages,"Provide localized user-friendly errors for network, auth, quota and internal errors.",High,"1) AI service errors mapped to TR/EN messages. 2) Network and permission errors show alerts.","aiTeacherService already implements many error mappings"
NFR1,NonFunctional,Performance & Timeout,"AI calls must have a timeout (30s) and app should remain responsive.",High,"1) AI requests timeout after 30s with message to user. 2) Loading indicators shown.","aiTeacherService uses Promise.race and 30s timeout"
NFR2,NonFunctional,Security,"Do not store OpenAI API key in client; use Cloud Functions. Secure IAP with server-side receipt check.",High,"1) OpenAI key stored in functions env not client. 2) Add server-side purchase verification.","README currently asks to place API key in openaiService - update for production"
NFR3,NonFunctional,Offline Support,"Firestore persistence enabled; app should support offline reads/writes.",Medium,"1) Data written offline syncs later. 2) UI shows offline indicator where appropriate.","src/firebase/config.ts enables persistence"
NFR4,NonFunctional,Localization,"Support Turkish and English in AI responses and some UI strings.",Medium,"1) AI responses adapt to detected language. 2) Key UI strings localized as needed.","detectLanguage present in AITeacherScreen; expand to app-wide i18n if needed"
NFR5,NonFunctional,Accessibility & Theming,"Dark mode support and readable contrast.",Low,"1) DarkModeContext toggles UI. 2) Styles provide dark variants.","Dark mode implemented via contexts"
NFR6,NonFunctional,Maintainability,"Separation of concerns: services handle logic, screens handle UI, contexts handle global state.",Medium,"1) Services unit-testable. 2) Minimal business logic in components.","Refactor where logic is duplicated"
RISK1,Risk,OpenAI Key Exposure,"README suggests setting API key directly; risk of leaking key in repo.",High,"Mitigation: Move key to Cloud Functions environment variables and remove direct usage in client.","Critical before production"
RISK2,Risk,IAP Validation,"No server-side receipt validation may allow fake purchases.",High,"Mitigation: Implement receipt verification in Cloud Functions and store verified status in Firestore.","Requires backend work"
RISK3,Risk,Firestore Rules Missing,"Ensure Firestore security rules restrict reads/writes to authorized users.",High,"Mitigation: Add and audit firestore.rules; test with rules emulator.","Check repository for rules file"
